# 4. torchvision 빌드 및 설치
python3 setup.py install --user

cat << 'EOF' > install_cusparselt.sh
#!/bin/bash
set -ex

# JetPack 6.x, CUDA 12.6 기준 cuSPARSELt 0.6.3.2 설치
CUSPARSELT_NAME="libcusparse_lt-linux-aarch64-0.6.3.2-archive"
curl --retry 3 -OLs \
  "https://developer.download.nvidia.com/compute/cusparselt/redist/libcusparse_lt/linux-aarch64/${CUSPARSELT_NAME}.tar.xz"
tar xf "${CUSPARSELT_NAME}.tar.xz"

sudo cp -a ${CUSPARSELT_NAME}/include/* /usr/local/cuda/include/
sudo cp -a ${CUSPARSELT_NAME}/lib/* /usr/local/cuda/lib64/

cd /
sudo rm -rf /install_cusparselt.sh "${CUSPARSELT_NAME}.tar.xz" ${CUSPARSELT_NAME}
sudo ldconfig
EOF

chmod +x install_cusparselt.sh


sudo ./install_cusparselt.sh

ls -l /usr/local/cuda/include/cusparseLt.h
ls -l /usr/local/cuda/lib64/libcusparseLt*


python3 -c "import torch; print(torch.__version__, torch.cuda.is_available(), torch.version.cuda)"

python3 -c "import torchvision; print(torchvision.__version__)"


python3 -c "import torch; print('PyTorch 버전:', torch.__version__); print('CUDA 가능 여부:', torch.cuda.is_available()); print('CUDA 버전:', torch.version.cuda); print('GPU 이름:', torch.cuda.get_device_name(0) if torch.cuda.is_available() else 'N/A')"




